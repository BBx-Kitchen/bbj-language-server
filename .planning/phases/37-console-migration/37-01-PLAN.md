---
phase: 37-console-migration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - bbj-vscode/src/language/java-interop.ts
  - bbj-vscode/src/language/bbj-ws-manager.ts
  - bbj-vscode/src/language/java-javadoc.ts
autonomous: true

must_haves:
  truths:
    - "java-interop.ts produces zero console.log/debug/warn output — all routed through logger"
    - "bbj-ws-manager.ts produces zero console.log/debug/warn output — all routed through logger"
    - "java-javadoc.ts produces zero console.log/debug/warn output — all routed through logger"
    - "console.error() calls in all three files remain untouched"
    - "Startup with debug OFF shows only essential summary lines from these files (BBj home, class count, config path)"
    - "Startup with debug ON shows verbose details (classpath entries, individual class resolution, javadoc scanning)"
  artifacts:
    - path: "bbj-vscode/src/language/java-interop.ts"
      provides: "Logger-based output for Java class loading and resolution"
      contains: "import { logger }"
    - path: "bbj-vscode/src/language/bbj-ws-manager.ts"
      provides: "Logger-based output for workspace initialization"
      contains: "import { logger }"
    - path: "bbj-vscode/src/language/java-javadoc.ts"
      provides: "Logger-based output for javadoc scanning"
      contains: "import { logger }"
  key_links:
    - from: "bbj-vscode/src/language/java-interop.ts"
      to: "bbj-vscode/src/language/logger.ts"
      via: "import { logger }"
      pattern: "logger\\.(info|debug|warn)\\("
    - from: "bbj-vscode/src/language/bbj-ws-manager.ts"
      to: "bbj-vscode/src/language/logger.ts"
      via: "import { logger }"
      pattern: "logger\\.(info|debug|warn)\\("
    - from: "bbj-vscode/src/language/java-javadoc.ts"
      to: "bbj-vscode/src/language/logger.ts"
      via: "import { logger }"
      pattern: "logger\\.(info|debug|warn)\\("
---

<objective>
Migrate all console.log/debug/warn calls in the three highest-volume server files to logger.info/debug/warn, making startup output respect the bbj.debug flag.

Purpose: These three files produce the most startup noise (40 of 45 migratable calls). Migrating them delivers the "quiet by default, verbose on-demand" experience for the majority of output.

Output: Three modified source files with zero remaining console.log/debug/warn calls (console.error untouched).
</objective>

<execution_context>
@/Users/beff/.claude/get-shit-done/workflows/execute-plan.md
@/Users/beff/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/35-logger-infrastructure/35-01-SUMMARY.md
@.planning/phases/36-settings-plumbing/36-01-SUMMARY.md

@bbj-vscode/src/language/logger.ts
@bbj-vscode/src/language/java-interop.ts
@bbj-vscode/src/language/bbj-ws-manager.ts
@bbj-vscode/src/language/java-javadoc.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate java-interop.ts and bbj-ws-manager.ts console calls</name>
  <files>bbj-vscode/src/language/java-interop.ts, bbj-vscode/src/language/bbj-ws-manager.ts</files>
  <action>
Add `import { logger } from './logger.js';` to both files (top of file, with other imports).

**java-interop.ts (8 non-error calls to migrate):**

- Line 87: `console.log(`Java interop connection config: ${this.interopHost}:${this.interopPort}`)` → `logger.debug(`Java interop connection config: ${this.interopHost}:${this.interopPort}`)` (verbose connection detail)
- Line 158: `console.warn("Load classpath from: " + classPath.join(', '))` → `logger.debug(() => "Load classpath from: " + classPath.join(', '))` (verbose, use lazy callback for array.join)
- Line 182: `console.warn("Load package classes: ", implicitJavaImports.join(', '))` → `logger.debug(() => "Load package classes: " + implicitJavaImports.join(', '))` (verbose, lazy callback; note: change comma to + since logger takes single string)
- Line 200: `console.debug("Loaded " + this.classpath.classes.length + " classes")` → `logger.info(() => "Loaded " + this.classpath.classes.length + " classes")` (essential summary: class count)
- Line 238: `console.debug("getTopLevelPackages not supported, skipping top-level package initialization")` → `logger.debug("getTopLevelPackages not supported, skipping top-level package initialization")` (verbose 1:1)
- Line 286: `console.debug(`Resolving class ${className}...`)` → `logger.debug(() => `Resolving class ${className}: ${javaClass.methods?.length ?? 0} methods, ${javaClass.fields?.length ?? 0} fields`)` (verbose, lazy callback for property access)
- Line 381: `console.warn(`Package name mismatch...`)` → `logger.warn(`Package name mismatch for class ${javaClass.name}: expected '${javaClass.packageName}', got '${packageName}'`)` (genuine warning, keep as warn)
- Line 453: `console.log('Java interop cache cleared')` → `logger.info('Java interop cache cleared')` (user-initiated action feedback)

DO NOT TOUCH the 6 `console.error()` calls (lines 69, 171, 242, 296, 335, 374).

**bbj-ws-manager.ts (17 non-error calls to migrate):**

- Line 34: `console.log('Initialization options received:', JSON.stringify(params.initializationOptions))` → `logger.debug(() => `Initialization options received: ${JSON.stringify(params.initializationOptions)}`)` (verbose, lazy callback for JSON.stringify; change from 2 args to template literal)
- Line 42: `console.log(`BBj home: ${this.bbjdir}`)` → `logger.info(`BBj home: ${this.bbjdir}`)` (essential summary)
- Line 43: `console.log(`Classpath from settings: ${this.classpathFromSettings}`)` → `logger.debug(`Classpath from settings: ${this.classpathFromSettings}`)` (verbose setting detail)
- Line 57: `console.log('Type resolution warnings disabled')` → `logger.info('Type resolution warnings disabled')` (essential: user toggled setting)
- Line 60: `console.log('Type resolution warnings enabled')` → `logger.info('Type resolution warnings enabled')` (essential: user toggled setting)
- Line 86: `console.log(`Loaded config.bbx from custom path: ${this.configPath}`)` → `logger.info(`Loaded config.bbx from custom path: ${this.configPath}`)` (essential: config loaded)
- Line 88: `console.warn(`Failed to load config.bbx from custom path ${this.configPath}: ${e}`)` → `logger.warn(`Failed to load config.bbx from custom path ${this.configPath}: ${e}`)` (warning 1:1)
- Line 98: `console.warn("No cfg/config.bbx found in bbjdir. No prefixes loaded.")` → `logger.warn("No cfg/config.bbx found in bbjdir. No prefixes loaded.")` (warning 1:1)
- Line 101: `console.warn("No bbjdir set. No classpath and prefixes loaded.")` → `logger.warn("No bbjdir set. No classpath and prefixes loaded.")` (warning 1:1)
- Line 115: `console.debug(`JavaDoc provider initialize ${wsJavadocFolders}`)` → `logger.debug(`JavaDoc provider initialize ${wsJavadocFolders}`)` (verbose 1:1)
- Line 129: `console.log(`Using classpath from VS Code settings: bbj.classpath="${this.classpathFromSettings}"`)` → `logger.debug(`Using classpath from VS Code settings: bbj.classpath="${this.classpathFromSettings}"`)` (verbose classpath detail)
- Line 130: `console.log(`Formatted for Java interop: ${JSON.stringify(classpathToUse)}`)` → `logger.debug(() => `Formatted for Java interop: ${JSON.stringify(classpathToUse)}`)` (verbose, lazy callback for JSON.stringify)
- Line 134: `console.log(`Loading classpath with entries: ${JSON.stringify(classpathToUse)}`)` → `logger.debug(() => `Loading classpath with entries: ${JSON.stringify(classpathToUse)}`)` (verbose, lazy callback for JSON.stringify)
- Line 136: `console.log(`Java Classes ${loaded ? '' : 'not '}loaded`)` → `logger.info(`Java Classes ${loaded ? '' : 'not '}loaded`)` (essential summary)
- Line 138: `console.warn("No classpath set. No Java classes loaded.")` → `logger.warn("No classpath set. No Java classes loaded.")` (warning 1:1)
- Line 141: `console.debug(`Implicit Java imports ${iiLoaded ? '' : 'not '}loaded`)` → `logger.debug(`Implicit Java imports ${iiLoaded ? '' : 'not '}loaded`)` (verbose 1:1)

DO NOT TOUCH the 2 `console.error()` calls (lines 144, 243).
  </action>
  <verify>
1. `npx tsc --noEmit` — zero TypeScript errors
2. `grep -n 'console\.\(log\|debug\|warn\)(' bbj-vscode/src/language/java-interop.ts` — zero matches
3. `grep -n 'console\.\(log\|debug\|warn\)(' bbj-vscode/src/language/bbj-ws-manager.ts` — zero matches
4. `grep -n 'console\.error(' bbj-vscode/src/language/java-interop.ts` — 6 matches (untouched)
5. `grep -n 'console\.error(' bbj-vscode/src/language/bbj-ws-manager.ts` — 2 matches (untouched)
6. `grep -c 'logger\.' bbj-vscode/src/language/java-interop.ts` — 8 or more matches (new logger calls)
7. `grep -c 'logger\.' bbj-vscode/src/language/bbj-ws-manager.ts` — 17 or more matches (new logger calls + import)
8. `npm test` — all tests pass
  </verify>
  <done>java-interop.ts has zero console.log/debug/warn calls (only console.error remains). bbj-ws-manager.ts has zero console.log/debug/warn calls (only console.error remains). Both files import logger and use appropriate levels (info for essential summaries, debug for verbose details, warn for warnings). TypeScript compiles, all tests pass.</done>
</task>

<task type="auto">
  <name>Task 2: Migrate java-javadoc.ts console calls</name>
  <files>bbj-vscode/src/language/java-javadoc.ts</files>
  <action>
Add `import { logger } from './logger.js';` to java-javadoc.ts (top of file, with other imports).

**java-javadoc.ts (6 non-error calls to migrate):**

- Line 50: `console.warn("Cancelation requested in JavadocProvider.")` → `logger.warn("Cancelation requested in JavadocProvider.")` (warning 1:1)
- Line 57: `console.debug(`Failed to read javadoc directory ${root.toString()}: ${e}`)` → `logger.debug(`Failed to read javadoc directory ${root.toString()}: ${e}`)` (verbose 1:1)
- Line 60: `console.debug(`Scanning directory for javadoc: ${root.toString()}`)` → `logger.debug(`Scanning directory for javadoc: ${root.toString()}`)` (verbose 1:1)
- Line 65: `console.debug(`Found ${fileName.toString()}`)` → `logger.debug(`Found ${fileName.toString()}`)` (verbose 1:1)
- Line 74: `console.debug(`JavadocProvider initialized with ${this.packages.size} package/-s.`)` → `logger.info(`JavadocProvider initialized with ${this.packages.size} packages.`)` (essential summary: package count. Also clean up "package/-s" to "packages")
- Line 156: `console.debug(`Javadoc for package '${packageName}' loaded.`)` → `logger.debug(`Javadoc for package '${packageName}' loaded.`)` (verbose 1:1)

DO NOT TOUCH the 2 `console.error()` calls (lines 153, 159).
  </action>
  <verify>
1. `npx tsc --noEmit` — zero TypeScript errors
2. `grep -n 'console\.\(log\|debug\|warn\)(' bbj-vscode/src/language/java-javadoc.ts` — zero matches
3. `grep -n 'console\.error(' bbj-vscode/src/language/java-javadoc.ts` — 2 matches (untouched)
4. `grep -c 'logger\.' bbj-vscode/src/language/java-javadoc.ts` — 6 or more matches
5. `npm test` — all tests pass
  </verify>
  <done>java-javadoc.ts has zero console.log/debug/warn calls (only console.error remains). File imports logger and uses info for package count summary, debug for verbose scanning details, warn for cancellation. TypeScript compiles, all tests pass.</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` — zero TypeScript compilation errors across entire project
2. `npm test` — all existing tests pass (no regressions)
3. `grep -rn 'console\.\(log\|debug\|warn\)(' bbj-vscode/src/language/java-interop.ts bbj-vscode/src/language/bbj-ws-manager.ts bbj-vscode/src/language/java-javadoc.ts` — zero matches (complete migration)
4. `grep -rn 'console\.error(' bbj-vscode/src/language/java-interop.ts bbj-vscode/src/language/bbj-ws-manager.ts bbj-vscode/src/language/java-javadoc.ts` — 10 matches total (all preserved)
5. `grep -rn "import.*logger" bbj-vscode/src/language/java-interop.ts bbj-vscode/src/language/bbj-ws-manager.ts bbj-vscode/src/language/java-javadoc.ts` — 3 matches (all files import logger)
</verification>

<success_criteria>
- Zero console.log/debug/warn calls remain in java-interop.ts, bbj-ws-manager.ts, java-javadoc.ts
- All console.error calls preserved untouched in those files
- Logger import present in all three files
- Essential summary lines use logger.info() (BBj home, class count, Java Classes loaded, JavadocProvider package count, config paths)
- Verbose details use logger.debug() (classpath entries, individual class resolution, javadoc scanning, JSON dumps)
- Warnings use logger.warn() (missing config, no classpath, package mismatch)
- Lazy evaluation callbacks used for expensive operations (JSON.stringify, array.join, property traversal)
- TypeScript compiles with zero errors
- All tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/37-console-migration/37-01-SUMMARY.md`
</output>
