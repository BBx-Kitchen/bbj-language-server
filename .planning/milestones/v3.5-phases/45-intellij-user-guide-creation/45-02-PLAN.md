---
phase: 45-intellij-user-guide-creation
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - documentation/docs/intellij/configuration.md
  - documentation/docs/intellij/commands.md
autonomous: true

must_haves:
  truths:
    - "Configuration page documents Settings UI path: Settings > Languages & Frameworks > BBj"
    - "Configuration page documents all settings: BBj Home, Node.js path, classpath, log level, Java Interop host/port, config.bbx path, EM URL, auto-save"
    - "Configuration page documents EM token authentication via Tools > Login to Enterprise Manager"
    - "Commands page documents all run shortcuts: Alt+G (GUI), Alt+B (BUI), Alt+D (DWC)"
    - "Commands page documents Compile toolbar button"
    - "Commands page documents Tools menu actions: Restart Language Server, Refresh Java Classes, Login to Enterprise Manager"
    - "Commands page documents editor context menu actions and Project View context menu"
  artifacts:
    - path: "documentation/docs/intellij/configuration.md"
      provides: "Complete settings reference for IntelliJ plugin"
      contains: "Languages & Frameworks"
    - path: "documentation/docs/intellij/commands.md"
      provides: "Complete command and shortcut reference"
      contains: "Alt+G"
  key_links:
    - from: "documentation/docs/intellij/commands.md"
      to: "documentation/docs/intellij/configuration.md"
      via: "cross-reference for EM authentication"
      pattern: "configuration"
---

<objective>
Write the IntelliJ Configuration page and Commands page — replacing the "Coming Soon" stubs with comprehensive documentation based on the actual IntelliJ plugin implementation.

Purpose: IntelliJ users need a complete settings reference (IJUG-03) and command/shortcut reference (IJUG-04) to configure and operate the BBj Language Support plugin effectively.

Output: Two complete documentation pages ready for the Docusaurus site.
</objective>

<execution_context>
@/Users/beff/.claude/get-shit-done/workflows/execute-plan.md
@/Users/beff/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

Reference for structural consistency:
@documentation/docs/vscode/configuration.md
@documentation/docs/vscode/commands.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Write IntelliJ Configuration page</name>
  <files>documentation/docs/intellij/configuration.md</files>
  <action>
Replace the "Coming Soon" stub content. Keep the existing frontmatter (sidebar_position: 4, title: Configuration).

Write comprehensive configuration documentation (IJUG-03). All settings are accessed via: **Settings > Languages & Frameworks > BBj** (or Preferences on macOS). This is an application-level settings page (not project-level like VS Code's settings.json).

Structure the page by setting groups matching the actual Settings UI layout:

**Accessing Settings section:**
- Open Settings: Cmd+, (macOS) or Ctrl+Alt+S (Windows/Linux)
- Navigate to: Languages & Frameworks > BBj
- All BBj plugin settings are on this single page

**BBj Environment section:**

"BBj Home" setting:
- Path to BBj installation directory (e.g., /opt/bbj or C:\bbj)
- Browse button for directory selection
- Auto-detects BBj Home if installed in standard locations (empty field triggers auto-detection)
- Validates path by checking for BBj.properties file in cfg/ subdirectory
- Required for most features to work (running programs, resolving libraries, finding config files)

"config.bbx Path" setting:
- Optional custom path to config.bbx file
- Default: {BBj Home}/cfg/config.bbx (used when field is empty)
- Only needed if using a non-standard config.bbx location

**Node.js Runtime section:**

"Node.js Path" setting:
- Path to Node.js executable
- Auto-detects from system PATH
- Validates version 18+
- If not found, plugin can auto-download a compatible Node.js version
- Required for the language server to run (the language server is a Node.js application)

**Classpath section:**

"Classpath Entry" setting:
- Dropdown populated from basis.classpath.* entries in BBj.properties
- Dynamically updates when BBj Home changes
- Determines which Java classes are available for code completion
- Must match a classpath entry defined in BBj Enterprise Manager

**Language Server section:**

"Log Level" setting:
- Dropdown with options: Error, Warn, Info, Debug
- Default: Info
- Debug level shows detailed information about Java class loading, classpath scanning, parser analysis, validation timing
- Changes take effect without restarting the language server

**Java Interop section:**

"Host" setting:
- Hostname for the Java interop service
- Default: localhost

"Port" setting:
- Port number for the Java interop service
- Default: 5008
- Auto-detected from BBj.properties when BBj Home is set
- Validates range 1-65535
- Must match the port BBjServices is using for the Java interop service

**Enterprise Manager section:**

"EM URL" setting:
- URL for Enterprise Manager
- Default: http://localhost:8888
- Used for BUI and DWC web runner (launching programs in browser)

"EM Token Authentication" — explain that BUI/DWC run commands require authentication:
1. Go to Tools > Login to Enterprise Manager
2. Enter EM username and password in the dialog
3. Plugin stores JWT token securely in IntelliJ's PasswordSafe (credential store)
4. Token is used automatically for subsequent BUI/DWC runs
5. Re-authenticate if token expires

**Run Settings section:**

"Auto-save before run" setting:
- Checkbox, default: enabled
- When enabled, automatically saves the current file before executing any run command

**Troubleshooting Configuration section:**
- "Verify BBj Home" — check Settings page, look for validation error on the field. Valid path shows no error, invalid path shows warning about missing BBj.properties.
- "Check Classpath" — if dropdown is empty, verify BBj Home is set correctly and BBj.properties contains basis.classpath.* entries
- "Language Server Logs" — set Log Level to Debug, open BBj Language Server tool window (bottom panel) to see detailed diagnostics. Set back to Info when done.

IMPORTANT: Do NOT reference VS Code settings.json, workspace settings, or environment variables. IntelliJ plugin uses a native Settings UI, not JSON configuration. Do NOT document bbj.debug as a separate setting — the IntelliJ plugin uses "Log Level" dropdown instead.
  </action>
  <verify>
Verify the file:
- No "Coming Soon" text remains
- grep for "Languages & Frameworks" returns match (Settings UI path)
- grep for "BBj Home" or "bbjHomePath" returns match
- grep for "Classpath" returns match
- grep for "Java Interop" returns match
- grep for "config.bbx" returns match
- grep for "Log Level" returns match
- grep for "EM URL" or "Enterprise Manager" returns match
- grep for "PasswordSafe" or "token" returns match (EM authentication)
- grep for "Auto-save" returns match
- Does NOT contain "settings.json" (VS Code concept)
- Does NOT contain "bbj.debug" (VS Code setting name — IntelliJ uses "Log Level")
- Frontmatter preserved (sidebar_position: 4, title: Configuration)
  </verify>
  <done>
Configuration page documents the complete Settings UI at Languages & Frameworks > BBj, covering all settings: BBj Home (with auto-detection), config.bbx path, Node.js path (with auto-detection/download), classpath entry dropdown, log level, Java Interop host/port (with auto-detection), EM URL, EM token authentication (Login via Tools menu, JWT stored in PasswordSafe), and auto-save before run.
  </done>
</task>

<task type="auto">
  <name>Task 2: Write IntelliJ Commands page</name>
  <files>documentation/docs/intellij/commands.md</files>
  <action>
Replace the "Coming Soon" stub content. Keep the existing frontmatter (sidebar_position: 5, title: Commands).

Write comprehensive commands documentation (IJUG-04) covering all IntelliJ plugin actions from the source analysis. Use the title "IntelliJ Commands" (matching VS Code's "VS Code Commands" title pattern).

Structure as follows:

**Run Commands section:**

"Run As BBj Program (Alt+G)" subsection:
- Runs the current BBj file as a GUI (desktop) application
- Action ID: bbj.runGui
- Available when: BBj source file is open and language server is ready
- Access: Alt+G keyboard shortcut, editor context menu (right-click > "Run As BBj Program"), or Project View context menu (right-click file > BBj Run > Run As BBj Program)

"Run As BUI Program (Alt+B)" subsection:
- Runs the current BBj file as a BUI (Browser User Interface) web application
- Action ID: bbj.runBui
- Requires: Enterprise Manager authentication (see Configuration page link)
- Opens program in default browser via EM URL
- Access: Alt+B keyboard shortcut or editor context menu

"Run As DWC Program (Alt+D)" subsection:
- Runs the current BBj file as a DWC (Dynamic Web Client) application
- Action ID: bbj.runDwc
- Requires: Enterprise Manager authentication (see Configuration page link)
- Opens program in default browser via EM URL
- Access: Alt+D keyboard shortcut or editor context menu

**Compile Command section:**
- Compiles the current BBj source file
- Action ID: bbj.compile
- Available when: BBj source file is open and language server is ready
- Access: Toolbar button (in main toolbar, before the Run Configuration area). No keyboard shortcut assigned by default.

**Tools Menu Commands section:**

"Restart BBj Language Server" subsection:
- Action ID: bbj.restartLanguageServer
- Available when: A BBj file is open in the editor
- Use when: Language server becomes unresponsive or after significant configuration changes

"Refresh Java Classes" subsection:
- Action ID: bbj.refreshJavaClasses
- Available when: Language server is started
- Reloads Java classpath and clears cached class information
- Use when: Classpath has changed (new JARs added, classpath entry updated)

"Login to Enterprise Manager" subsection:
- Action ID: bbj.loginEM
- Prompts for EM username and password
- Stores JWT token in IntelliJ's PasswordSafe (secure credential storage)
- Required before using BUI or DWC run commands
- Cross-reference: See Configuration page for EM URL setting

**Keyboard Shortcuts Summary section — table format:**
| Command | Shortcut | Description |
| Run As BBj Program | Alt+G | Run as GUI (desktop) application |
| Run As BUI Program | Alt+B | Run as BUI web application |
| Run As DWC Program | Alt+D | Run as DWC web application |
| Compile BBj File | (toolbar button) | Compile current BBj file |

Note: Shortcuts use the default keymap. Custom keymaps may differ. Users can customize shortcuts in Settings > Keymap > search "BBj".

**Context Menus section:**

"Editor Context Menu" subsection:
- Right-click in a BBj file editor to see run actions at the top of the menu
- Actions: Run As BBj Program, Run As BUI Program, Run As DWC Program

"Project View Context Menu" subsection:
- Right-click a BBj file in the Project tool window
- Shows "BBj Run" submenu containing: Run As BBj Program, Run As BUI Program, Run As DWC Program

**Toolbar Buttons section:**
- Compile button appears in the main toolbar when editing BBj files
- Located before the Run Configuration dropdown area
- Run commands are accessed via keyboard shortcuts and context menus (not toolbar)

**Auto-Save Option section:**
- When enabled in Settings (Languages & Frameworks > BBj), files are automatically saved before any run command executes
- Enabled by default
- Link to Configuration page for the setting

**Requirements for Commands section:**
- BBj Home must be configured
- BBjServices must be running
- Language server must be in "Ready" state (check status bar widget)
- For BUI/DWC: Enterprise Manager must be accessible and user must be authenticated (Tools > Login to Enterprise Manager)

IMPORTANT: Do NOT include commands that are VS Code-only (Decompile, Denumber, Show config.bbx, Show BBj.properties, Open Enterprise Manager, Show Classpath Entries, Command Palette access). Only document actions that exist in the IntelliJ plugin based on plugin.xml source analysis.
  </action>
  <verify>
Verify the file:
- No "Coming Soon" text remains
- grep for "Alt+G" returns match
- grep for "Alt+B" returns match
- grep for "Alt+D" returns match
- grep for "Compile" returns match
- grep for "Restart BBj Language Server" returns match
- grep for "Refresh Java Classes" returns match
- grep for "Login to Enterprise Manager" returns match
- grep for "Context Menu" returns match
- grep for "Toolbar" returns match
- Does NOT contain "Decompile" (VS Code only)
- Does NOT contain "Denumber" (VS Code only)
- Does NOT contain "Command Palette" (VS Code concept)
- Does NOT contain "Alt+C" (VS Code shortcut for compile — IntelliJ has no keyboard shortcut for compile)
- Does NOT contain "Alt+X" or "Alt+N" (VS Code only shortcuts)
- Frontmatter preserved (sidebar_position: 5, title: Commands)
  </verify>
  <done>
Commands page documents all IntelliJ plugin commands: Run As BBj Program (Alt+G), Run As BUI Program (Alt+B), Run As DWC Program (Alt+D), Compile (toolbar button), Restart Language Server (Tools menu), Refresh Java Classes (Tools menu), Login to Enterprise Manager (Tools menu). Includes keyboard shortcuts table, editor context menu actions, Project View context menu, toolbar buttons, and auto-save option. No phantom VS Code-only commands included.
  </done>
</task>

</tasks>

<verification>
Phase-level checks for this plan:
1. Both files exist and contain no "Coming Soon" text
2. configuration.md documents all settings from IJUG-03: BBj Home, classpath, interop host/port, config.bbx, log level (debug flag equivalent), EM token auth
3. commands.md documents all actions from IJUG-04: Alt+G/B/D shortcuts, compile toolbar button, context menu actions, Tools menu commands
4. No VS Code-specific terminology (settings.json, Command Palette, Output panel, VSIX, Alt+C, Alt+X, Alt+N)
5. EM token authentication documented in both files (configuration shows the setting, commands shows the login action)
6. Docusaurus site builds without errors: cd documentation && npm run build
</verification>

<success_criteria>
- IJUG-03 (Configuration) requirements fully satisfied: Settings UI path, all settings documented (BBj Home, classpath, interop host/port, config.bbx, debug/log level, EM token auth)
- IJUG-04 (Commands) requirements fully satisfied: all keyboard shortcuts (Alt+G/B/D), toolbar buttons (Compile), context menu actions, Tools menu commands
- All pages use IntelliJ-specific terminology and navigation paths
- Cross-references between configuration and commands pages for EM authentication
- Site builds successfully
</success_criteria>

<output>
After completion, create `.planning/phases/45-intellij-user-guide-creation/45-02-SUMMARY.md`
</output>
