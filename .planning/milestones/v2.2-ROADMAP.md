# Milestone v2.2: IntelliJ Build & Release Automation

**Status:** ✅ SHIPPED 2026-02-05
**Phases:** 21-23
**Total Plans:** 3

## Overview

Unified CI/CD automation for both VS Code and IntelliJ extensions. Preview builds on every push to main, manual production releases with GitHub Release artifacts.

## Phases

### Phase 21: Preview Workflow

**Goal**: IntelliJ plugin builds automatically on every push to main, synchronized with VS Code builds
**Depends on**: Nothing (first phase of milestone)
**Requirements**: PREV-01, PREV-02, PREV-03, PREV-04
**Success Criteria** (what must be TRUE):
  1. Push to main triggers IntelliJ plugin build (in addition to existing VS Code build)
  2. IntelliJ plugin version matches VS Code version from package.json
  3. IntelliJ build waits for VS Code build to complete (consumes main.cjs artifact)
  4. IntelliJ .zip artifact is downloadable from workflow run
**Plans**: 1 plan

Plans:
- [x] 21-01-PLAN.md - Add IntelliJ build to preview workflow with version sync ✓

### Phase 22: Release Workflow

**Goal**: Manual release trigger produces both extensions with matching versions and creates GitHub Release
**Depends on**: Phase 21
**Requirements**: RELS-01, RELS-02, RELS-03, RELS-04
**Success Criteria** (what must be TRUE):
  1. Manual workflow dispatch builds both VS Code and IntelliJ extensions
  2. Input version (x.y.0) applied to both extensions identically
  3. GitHub Release created with .vsix and .zip attached
  4. Release notes include IntelliJ installation instructions
**Plans**: 1 plan

Plans:
- [x] 22-01-PLAN.md - Extend manual-release workflow with IntelliJ build and GitHub Release ✓

### Phase 23: PR Validation

**Goal**: Pull requests that affect IntelliJ plugin are validated before merge
**Depends on**: Phase 22
**Requirements**: PRVAL-01, PRVAL-02
**Success Criteria** (what must be TRUE):
  1. PRs touching bbj-intellij/ trigger IntelliJ build validation
  2. Plugin verifier runs on release workflow builds (catches compatibility issues)
**Plans**: 1 plan

Plans:
- [x] 23-01-PLAN.md — PR validation workflow with path filtering and plugin verification on releases ✓

## Progress

**Execution Order:** 21 -> 22 -> 23

| Phase | Milestone | Plans Complete | Status | Completed |
|-------|-----------|----------------|--------|-----------|
| 21. Preview Workflow | v2.2 | 1/1 | ✓ Complete | 2026-02-05 |
| 22. Release Workflow | v2.2 | 1/1 | ✓ Complete | 2026-02-05 |
| 23. PR Validation | v2.2 | 1/1 | ✓ Complete | 2026-02-05 |

---

## Milestone Summary

**Key Decisions:**

- Use `providers.gradleProperty("version")` over `systemProperty` — simpler Gradle API for CI injection
- Keep job name `publish-preview` for backward compatibility
- Rename IntelliJ plugin to `bbj-intellij-{version}.zip` for clarity in GitHub Release assets
- Use 1-day artifact retention for release workflow — short-lived intermediates, permanent release assets
- Include IntelliJ installation instructions directly in release body — primary distribution channel
- verifyPlugin only in release builds — too slow for PR validation (downloads multiple IDE versions)
- GITHUB_TOKEN required for verifyPlugin to avoid API rate limiting

**Issues Resolved:**

- IntelliJ plugin version now synchronized with VS Code automatically
- GitHub Releases now contain both extension artifacts with installation instructions
- PRs affecting IntelliJ plugin are validated before merge

**Issues Deferred:**

- JetBrains Marketplace publishing (requires manual first upload)
- Plugin signing (only required for Marketplace)
- EAP channel publishing (only relevant when publishing to Marketplace)

**Technical Debt Incurred:**

None — clean implementation of all three workflows.

---
*Archived: 2026-02-05*
*For current project status, see .planning/ROADMAP.md (if next milestone started)*
