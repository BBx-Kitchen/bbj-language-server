# Roadmap: BBj Language Server

## Milestones

- âœ… **v1.0 Internal Alpha** â€” Phases 1-6 (shipped 2026-02-01)
- âœ… **v1.1 Polish & Run Commands** â€” Phases 7-10 (shipped 2026-02-02)
- âœ… **v1.2 Run Fixes & Marketplace** â€” Phases 11-13 (shipped 2026-02-02)
- âœ… **v2.0 Langium 4 Upgrade** â€” Phases 14-20 (shipped 2026-02-04)
- âœ… **v2.1 Feature Gap Analysis** â€” Research only (shipped 2026-02-04)
- âœ… **v2.2 IntelliJ Build & Release Automation** â€” Phases 21-23 (shipped 2026-02-05)
- âœ… **v3.0 Improving BBj Language Support** â€” Phases 24-27 (shipped 2026-02-06)
- âœ… **v3.1 PRIO 1+2 Issue Burndown** â€” Phases 28-31 (shipped 2026-02-07)
- âœ… **v3.2 Bug Fix Release** â€” Phases 32-34 (shipped 2026-02-08)
- âœ… **v3.3 Output & Diagnostic Cleanup** â€” Phases 35-39 (shipped 2026-02-08)
- âœ… **v3.4 0.8.0 Issue Closure** â€” Phases 40-43 (shipped 2026-02-08)
- âœ… **v3.5 Documentation for 0.8.0 Release** â€” Phases 44-47 (shipped 2026-02-09)
- âœ… **v3.6 IntelliJ Platform API Compatibility** â€” Phases 48-49 (shipped 2026-02-10)
- ðŸš§ **v3.7 Diagnostic Quality & BBjCPL Integration** â€” Phases 50-53 (in progress)

## Phases

<details>
<summary>âœ… v1.0 Internal Alpha (Phases 1-6) â€” SHIPPED 2026-02-01</summary>

- [x] Phase 1: Plugin Scaffolding (3/3 plans)
- [x] Phase 2: Syntax Highlighting (2/2 plans)
- [x] Phase 3: Settings & Runtime (3/3 plans)
- [x] Phase 4: Language Server Integration (5/5 plans)
- [x] Phase 5: Java Interop (3/3 plans)
- [x] Phase 6: Distribution (3/3 plans)

</details>

<details>
<summary>âœ… v1.1 Polish & Run Commands (Phases 7-10) â€” SHIPPED 2026-02-02</summary>

- [x] Phase 7: Brand Icons (1/1 plan)
- [x] Phase 8: Run Commands (2/2 plans)
- [x] Phase 9: Structure View (1/1 plan)
- [x] Phase 10: Bug Fixes & Polish (2/2 plans)

</details>

<details>
<summary>âœ… v1.2 Run Fixes & Marketplace (Phases 11-13) â€” SHIPPED 2026-02-02</summary>

- [x] Phase 11: Run Command Fixes (2/2 plans)
- [x] Phase 12: Marketplace Preparation (2/2 plans)
- [x] Phase 13: Plugin ID Fix (1/1 plan)

</details>

<details>
<summary>âœ… v2.0 Langium 4 Upgrade (Phases 14-20) â€” SHIPPED 2026-02-04</summary>

- [x] Phase 14: Deps & Grammar (1/1 plan)
- [x] Phase 15: Core API Renames & Type Constants (2/2 plans)
- [x] Phase 16: API Signature & Deprecated API Migration (2/2 plans)
- [x] Phase 17: Build Verification & Test Suite (2/2 plans)
- [x] Phase 18: Functional Verification & Release (2/2 plans)
- [x] Phase 19: Test Plan (1/1 plan)
- [x] Phase 20: Human QA Testing (1/1 plan)

</details>

<details>
<summary>âœ… v2.1 Feature Gap Analysis â€” SHIPPED 2026-02-04</summary>

Research-only milestone â€” no phases.

</details>

<details>
<summary>âœ… v2.2 IntelliJ Build & Release Automation (Phases 21-23) â€” SHIPPED 2026-02-05</summary>

- [x] Phase 21: Preview Workflow (1/1 plan)
- [x] Phase 22: Release Workflow (1/1 plan)
- [x] Phase 23: PR Validation (1/1 plan)

</details>

<details>
<summary>âœ… v3.0 Improving BBj Language Support (Phases 24-27) â€” SHIPPED 2026-02-06</summary>

- [x] Phase 24: Grammar & Parsing Fixes (3/3 plans)
- [x] Phase 25: Type Resolution & Crash Fixes (3/3 plans)
- [x] Phase 26: CPU Stability (2/2 plans)
- [x] Phase 27: IDE Polish (3/3 plans)

</details>

<details>
<summary>âœ… v3.1 PRIO 1+2 Issue Burndown (Phases 28-31) â€” SHIPPED 2026-02-07</summary>

- [x] Phase 28: Variable Scoping & Declaration Order (4/4 plans)
- [x] Phase 29: DEF FN & Inheritance Resolution (3/3 plans)
- [x] Phase 30: Java Reflection & Error Reporting (3/3 plans)
- [x] Phase 31: Extension Settings & File Types (3/3 plans)

</details>

<details>
<summary>âœ… v3.2 Bug Fix Release (Phases 32-34) â€” SHIPPED 2026-02-08</summary>

- [x] Phase 32: Regression Fixes (4/4 plans)
- [x] Phase 33: Parser & Lexer Fixes (4/4 plans)
- [x] Phase 34: Diagnostic Polish (2/2 plans)

</details>

<details>
<summary>âœ… v3.3 Output & Diagnostic Cleanup (Phases 35-39) â€” SHIPPED 2026-02-08</summary>

- [x] Phase 35: Logger Infrastructure (1/1 plan)
- [x] Phase 36: Settings Plumbing (1/1 plan)
- [x] Phase 37: Console Migration (2/2 plans)
- [x] Phase 38: Diagnostic Filtering (1/1 plan)
- [x] Phase 39: Parser Diagnostics (1/1 plan)

</details>

<details>
<summary>âœ… v3.4 0.8.0 Issue Closure (Phases 40-43) â€” SHIPPED 2026-02-08</summary>

- [x] Phase 40: Parser Fix (1/1 plan)
- [x] Phase 41: File Type Fix (1/1 plan)
- [x] Phase 42: Toolbar Button Polish (1/1 plan)
- [x] Phase 43: Run Command Fixes (1/1 plan)

</details>

<details>
<summary>âœ… v3.5 Documentation for 0.8.0 Release (Phases 44-47) â€” SHIPPED 2026-02-09</summary>

- [x] Phase 44: Site Chrome for Dual-IDE Support (2/2 plans)
- [x] Phase 45: IntelliJ User Guide Creation (2/2 plans)
- [x] Phase 46: VS Code User Guide Audit (2/2 plans)
- [x] Phase 47: Documentation Cleanup (1/1 plan)

</details>

<details>
<summary>âœ… v3.6 IntelliJ Platform API Compatibility (Phases 48-49) â€” SHIPPED 2026-02-10</summary>

- [x] Phase 48: Fix Scheduled-for-Removal APIs (1/1 plan)
- [x] Phase 49: Fix Deprecated APIs and Verify (1/1 plan)

</details>

### v3.7 Diagnostic Quality & BBjCPL Integration (In Progress)

**Milestone Goal:** Give BBj developers authoritative, noise-free error diagnostics by reducing cascading parser noise, preserving document outline despite syntax errors, and integrating BBjCPL compiler output as a verified, independent diagnostic source.

- [x] **Phase 50: Diagnostic Noise Reduction** - Suppress cascading linking/validation errors when parse errors exist; clean diagnostic hierarchy (completed 2026-02-19)
- [x] **Phase 51: Outline Resilience** - Document symbols survive syntax errors; Structure View stays populated on partial ASTs (completed 2026-02-19)
- [x] **Phase 52: BBjCPL Foundation** - Discover output format empirically, build verified compiler service with safe process lifecycle (completed 2026-02-20)
- [x] **Phase 53: BBjCPL Diagnostic Integration** - Wire compiler service into document lifecycle; BBjCPL errors labeled and shown with hierarchy enforced (completed 2026-02-20)

## Phase Details

### Phase 50: Diagnostic Noise Reduction
**Goal**: Users see only meaningful errors â€” a single syntax error produces 1-3 diagnostics instead of 40+ cascading linking noise
**Depends on**: Nothing (independent of BBjCPL)
**Requirements**: DIAG-01, DIAG-02
**Success Criteria** (what must be TRUE):
  1. A file with a single syntax error shows only that syntax error and no downstream linking or validation errors in the Problems panel
  2. Warnings and hints are absent from the Problems panel when any hard error (parse or semantic) is present in the file
  3. When the syntax error is fixed, warnings and hints reappear without requiring a file save or reload
**Plans**: 2 plans
Plans:
- [ ] 50-01-PLAN.md â€” Core diagnostic suppression logic with extensible hierarchy in BBjDocumentValidator
- [ ] 50-02-PLAN.md â€” Settings wiring (package.json, initializationOptions, config change) and status bar indicator

### Phase 51: Outline Resilience
**Goal**: Structure View stays populated even when a file has parse errors â€” methods and classes before and after the error point remain visible
**Depends on**: Nothing (independent of BBjCPL and Phase 50)
**Requirements**: OUTL-01, OUTL-02
**Success Criteria** (what must be TRUE):
  1. Opening a file with a syntax error mid-method does not produce a blank or errored Structure View in either VS Code or IntelliJ
  2. Methods and classes defined before the syntax error point are visible in Structure View
  3. Methods and classes defined after the syntax error point are visible in Structure View
  4. No TypeError or unhandled exception is thrown during document symbol computation on a partial AST
**Plans**: 1 plan
Plans:
- [ ] 51-01-PLAN.md -- Error-safe BBjDocumentSymbolProvider with per-node recovery, (parse error) fallback, deep-walk fallback, and tests

### Phase 52: BBjCPL Foundation
**Goal**: A verified, safe BBjCPL compiler service exists with empirically validated output parsing and complete process lifecycle management
**Depends on**: Nothing (independently buildable and testable)
**Requirements**: CPL-01, CPL-02, CPL-03, CPL-04
**Success Criteria** (what must be TRUE):
  1. Real BBjCPL stderr output has been captured against known-bad files and committed as test fixtures in the repository
  2. The output parser produces LSP Diagnostic objects with accurate line numbers when run against those real fixtures
  3. A second invocation on the same document aborts any in-flight compiler process before starting a new one, leaving no orphaned processes
  4. When BBjCPL does not complete within the configured timeout, the process is killed and execution continues without hanging the language server
**Plans**: 2 plans
Plans:
- [ ] 52-01-PLAN.md â€” Capture real bbjcpl output as test fixtures, TDD the stderr-to-LSP-Diagnostic parser
- [ ] 52-02-PLAN.md â€” BBjCPLService with process lifecycle (spawn, abort-on-resave, timeout, ENOENT) and DI registration

### Phase 53: BBjCPL Diagnostic Integration
**Goal**: BBjCPL compiler errors appear in the Problems panel on save, labeled "BBjCPL", with diagnostic hierarchy enforced and graceful degradation when BBj is not installed
**Depends on**: Phase 52 (BBjCPL Foundation), Phase 50 (Diagnostic Noise Reduction), Phase 51 (Outline Resilience)
**Requirements**: CPL-05, CPL-06, CPL-07, CPL-08
**Success Criteria** (what must be TRUE):
  1. Saving a file with a compiler error shows a diagnostic labeled with source "BBjCPL" in the Problems panel of both VS Code and IntelliJ
  2. When BBjCPL reports errors, Langium parser errors for the same file are suppressed; BBjCPL errors take precedence in the hierarchy
  3. Setting `bbj.compiler.trigger` to `"off"` stops BBjCPL invocation and falls back to Langium-only diagnostics without requiring a reload
  4. On a machine where BBj is not installed, saving a file produces no error notifications and Langium diagnostics continue to work normally
  5. Ten rapid saves in succession do not cause CPU to spike or diagnostic flicker in the Problems panel
**Plans**: 2 plans
Plans:
- [ ] 53-01-PLAN.md â€” Source label rename, diagnostic hierarchy extension, merge function, trigger setting plumbing
- [ ] 53-02-PLAN.md â€” BBjCPL wiring in buildDocuments() with debounce, client status bar, integration tests

## Progress

**Execution Order:** 50 â†’ 51 â†’ 52 â†’ 53

| Phase | Milestone | Plans Complete | Status | Completed |
|-------|-----------|----------------|--------|-----------|
| 1-6 | v1.0 Internal Alpha | 19/19 | Complete | 2026-02-01 |
| 7-10 | v1.1 Polish & Run Commands | 6/6 | Complete | 2026-02-02 |
| 11-13 | v1.2 Run Fixes & Marketplace | 5/5 | Complete | 2026-02-02 |
| 14-20 | v2.0 Langium 4 Upgrade | 11/11 | Complete | 2026-02-04 |
| N/A | v2.1 Feature Gap Analysis | N/A | Complete | 2026-02-04 |
| 21-23 | v2.2 IntelliJ Build & Release | 3/3 | Complete | 2026-02-05 |
| 24-27 | v3.0 BBj Language Support | 11/11 | Complete | 2026-02-06 |
| 28-31 | v3.1 PRIO 1+2 Burndown | 13/13 | Complete | 2026-02-07 |
| 32-34 | v3.2 Bug Fix Release | 10/10 | Complete | 2026-02-08 |
| 35-39 | v3.3 Output & Diagnostic Cleanup | 6/6 | Complete | 2026-02-08 |
| 40-43 | v3.4 0.8.0 Issue Closure | 4/4 | Complete | 2026-02-08 |
| 44-47 | v3.5 Documentation | 7/7 | Complete | 2026-02-09 |
| 48-49 | v3.6 API Compatibility | 2/2 | Complete | 2026-02-10 |
| 50. Diagnostic Noise Reduction | 2/2 | Complete   | 2026-02-19 | - |
| 51. Outline Resilience | 1/1 | Complete    | 2026-02-19 | - |
| 52. BBjCPL Foundation | 2/2 | Complete    | 2026-02-20 | - |
| 53. BBjCPL Diagnostic Integration | 2/2 | Complete    | 2026-02-20 | - |

**Total:** 14 milestones shipped, 49 phases complete, 121 plans shipped

---

*Roadmap last updated: 2026-02-19 after v3.7 roadmap creation*
